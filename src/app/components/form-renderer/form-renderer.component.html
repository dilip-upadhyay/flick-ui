<div class="form-renderer">
  <!-- Form Header -->
  <div class="form-header" *ngIf="config.title || config.description">
    <h2 *ngIf="config.title" class="form-title">{{ config.title }}</h2>
    <p *ngIf="config.description" class="form-description">{{ config.description }}</p>
  </div>

  <!-- Material Form -->
  <form [formGroup]="form" (ngSubmit)="onSubmit()" [class]="getFormLayoutClasses()">
    
    <!-- Form Fields -->
    <div 
      *ngFor="let field of config.fields" 
      [class]="getFieldWrapperClasses(field)">

      <!-- Text Input (text, email, password, tel, number) -->
      <ui-input
        *ngIf="field.type === 'text' || field.type === 'email' || field.type === 'password' || field.type === 'tel' || field.type === 'number'"
        [id]="field.id"
        [label]="field.label"
        [type]="field.type"
        [placeholder]="field.placeholder || ''"
        [required]="field.required || false"
        [hint]="field.helpText || ''"
        [errors]="getFieldErrors(field.id)"
        [suffixIcon]="getSuffixIcon(field.type)"
        [formControlName]="field.id">
      </ui-input>

      <!-- Textarea -->
      <ui-textarea
        *ngIf="field.type === 'textarea'"
        [id]="field.id"
        [label]="field.label"
        [placeholder]="field.placeholder || ''"
        [required]="field.required || false"
        [hint]="field.helpText || ''"
        [errors]="getFieldErrors(field.id)"
        [rows]="4"
        [formControlName]="field.id">
      </ui-textarea>

      <!-- Date Input -->
      <ui-datepicker
        *ngIf="field.type === 'date'"
        [id]="field.id"
        [label]="field.label"
        [required]="field.required || false"
        [hint]="field.helpText || ''"
        [errors]="getFieldErrors(field.id)"
        [formControlName]="field.id">
      </ui-datepicker>

      <!-- Select Dropdown -->
      <ui-select
        *ngIf="field.type === 'select'"
        [id]="field.id"
        [label]="field.label"
        [placeholder]="field.placeholder || 'Select an option'"
        [required]="field.required || false"
        [hint]="field.helpText || ''"
        [errors]="getFieldErrors(field.id)"
        [options]="getSelectOptions(field)"
        [formControlName]="field.id">
      </ui-select>

      <!-- Checkbox -->
      <ui-checkbox
        *ngIf="field.type === 'checkbox'"
        [id]="field.id"
        [label]="field.label"
        [checkboxLabel]="field.placeholder || field.label"
        [required]="field.required || false"
        [hint]="field.helpText || ''"
        [errors]="getFieldErrors(field.id)"
        [options]="getCheckboxOptions(field)"
        [formControlName]="field.id">
      </ui-checkbox>

      <!-- Radio Buttons -->
      <ui-radio
        *ngIf="field.type === 'radio'"
        [id]="field.id"
        [label]="field.label"
        [required]="field.required || false"
        [hint]="field.helpText || ''"
        [errors]="getFieldErrors(field.id)"
        [options]="getRadioOptions(field)"
        [formControlName]="field.id">
      </ui-radio>

      <!-- File Input -->
      <ui-file-upload
        *ngIf="field.type === 'file'"
        [id]="field.id"
        [label]="field.label"
        [buttonLabel]="field.placeholder || 'Choose File'"
        [required]="field.required || false"
        [disabled]="field.disabled || false"
        [hint]="field.helpText || ''"
        [errors]="getFieldErrors(field.id)"
        [accept]="field.accept || ''"
        [multiple]="field.multiple || false"
        (fileChanged)="onFileChange(field.id, $event)">
      </ui-file-upload>
    </div>

    <!-- Form Actions -->
    <div class="form-actions" *ngIf="config.actions && config.actions.length > 0">
      <ui-button
        *ngFor="let action of config.actions"
        [type]="action.type"
        [variant]="action.variant || 'primary'"
        [label]="action.label"
        [disabled]="action.disabled || (action.type === 'submit' && (form.invalid || isSubmitting))"
        [loading]="action.type === 'submit' && isSubmitting"
        [icon]="getActionIcon(action.type)"
        (buttonClick)="handleActionClick(action)"
        class="action-button">
      </ui-button>
    </div>
  </form>
</div>
